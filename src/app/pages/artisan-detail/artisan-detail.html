<!-- Indicateur de chargement -->
<div *ngIf="isLoading" class="loading-container">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Chargement...</span>
  </div>
  <p class="mt-3">Chargement des informations de l'artisan...</p>
</div>

<!-- Contenu de la page artisan -->
<div *ngIf="!isLoading && artisan" class="container-fluid">
  
  <!-- Section Hero avec informations principales -->
  <section class="hero-section">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <div class="artisan-info">
            <!-- Badge de spécialité -->
            <span class="badge bg-primary mb-3">{{ artisan.specialty }}</span>
            
            <!-- Nom de l'artisan -->
            <h1 class="display-4 fw-bold mb-3">{{ artisan.name }}</h1>
            
            <!-- Localisation -->
            <p class="lead text-muted mb-3">
              <i class="fas fa-map-marker-alt me-2"></i>
              {{ artisan.location }}
            </p>
            
            <!-- Note avec étoiles -->
            <div class="rating-container mb-4">
              <div class="stars me-3">
                <span *ngFor="let star of stars" 
                      class="star" 
                      [class.filled]="star">
                  <i class="fas fa-star"></i>
                </span>
              </div>
              <span class="rating-text">{{ artisan.note }}/5</span>
            </div>
            
            <!-- Boutons d'action -->
            <div class="action-buttons">
              <button class="btn btn-primary btn-lg me-3" 
                      (click)="scrollToContact()">
                <i class="fas fa-envelope me-2"></i>
                Contacter
              </button>
              
              <a *ngIf="artisan.website" 
                 [href]="artisan.website" 
                 target="_blank" 
                 class="btn btn-outline-primary btn-lg">
                <i class="fas fa-globe me-2"></i>
                Site Web
              </a>
            </div>
          </div>
        </div>
        
        <div class="col-lg-6">
          <div class="artisan-image">
            <!-- Image placeholder ou photo de l'artisan -->
            <div class="image-placeholder">
              <i class="fas fa-user-circle"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Section À propos -->
  <section class="about-section py-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2 class="section-title">À propos de {{ artisan.name }}</h2>
          <div class="about-content">
            <p class="lead">{{ artisan.about }}</p>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Section Informations de contact -->
  <section class="contact-info-section py-5 bg-light">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-6">
          <h2 class="section-title text-center mb-4">Informations de contact</h2>
          
          <div class="contact-cards">
            <!-- Email -->
            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="contact-info">
                <h5>Email</h5>
                <a [href]="'mailto:' + artisan.email">{{ artisan.email }}</a>
              </div>
            </div>
            
            <!-- Site web -->
            <div class="contact-card" *ngIf="artisan.website">
              <div class="contact-icon">
                <i class="fas fa-globe"></i>
              </div>
              <div class="contact-info">
                <h5>Site Web</h5>
                <a [href]="artisan.website" target="_blank">{{ artisan.website }}</a>
              </div>
            </div>
            
            <!-- Localisation -->
            <div class="contact-card">
              <div class="contact-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="contact-info">
                <h5>Localisation</h5>
                <p>{{ artisan.location }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Section Formulaire de contact -->
  <section class="contact-form-section py-5" id="contact">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <h2 class="section-title text-center mb-4">Envoyer un message</h2>
          
          <!-- Message de succès -->
          <div *ngIf="isSubmitted" class="alert alert-success" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            Votre message a été envoyé avec succès !
          </div>
          
          <!-- Formulaire -->
          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()" *ngIf="!isSubmitted">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="name" class="form-label">Nom complet *</label>
                <input type="text" 
                       class="form-control" 
                       id="name" 
                       formControlName="name"
                       [class.is-invalid]="contactForm.get('name')?.invalid && contactForm.get('name')?.touched">
                <div class="invalid-feedback">
                  Veuillez saisir votre nom (minimum 2 caractères).
                </div>
              </div>
              
              <div class="col-md-6 mb-3">
                <label for="subject" class="form-label">Sujet *</label>
                <input type="text" 
                       class="form-control" 
                       id="subject" 
                       formControlName="subject"
                       [class.is-invalid]="contactForm.get('subject')?.invalid && contactForm.get('subject')?.touched">
                <div class="invalid-feedback">
                  Veuillez saisir un sujet (minimum 5 caractères).
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <label for="message" class="form-label">Message *</label>
              <textarea class="form-control" 
                        id="message" 
                        rows="5" 
                        formControlName="message"
                        [class.is-invalid]="contactForm.get('message')?.invalid && contactForm.get('message')?.touched"></textarea>
              <div class="invalid-feedback">
                Veuillez saisir votre message (minimum 10 caractères).
              </div>
            </div>
            
            <div class="text-center">
              <button type="submit" 
                      class="btn btn-primary btn-lg"
                      [disabled]="contactForm.invalid || isSubmitting">
                <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2"></span>
                <i *ngIf="!isSubmitting" class="fas fa-paper-plane me-2"></i>
                {{ isSubmitting ? 'Envoi...' : 'Envoyer le message' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Bouton de retour -->
  <section class="back-section py-4">
    <div class="container">
      <div class="text-center">
        <button class="btn btn-outline-secondary" (click)="goBack()">
          <i class="fas fa-arrow-left me-2"></i>
          Retour à la liste
        </button>
      </div>
    </div>
  </section>
</div>

<!-- Message d'erreur si l'artisan n'est pas trouvé -->
<div *ngIf="!isLoading && !artisan" class="container">
  <div class="row justify-content-center">
    <div class="col-lg-6 text-center">
      <div class="error-message">
        <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
        <h2>Artisan non trouvé</h2>
        <p class="text-muted">L'artisan que vous recherchez n'existe pas ou a été supprimé.</p>
        <button class="btn btn-primary" routerLink="/artisans">
          <i class="fas fa-arrow-left me-2"></i>
          Retour à la liste des artisans
        </button>
      </div>
    </div>
  </div>
</div>
